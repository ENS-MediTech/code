<?php
$NomFichier = 'codeville.txt';
$tabloVille = file($NomFichier);

// rand(x, y) fournit un nombre au hasard entre x et y
$n = rand(0, sizeof($tabloNomFamille) - 1); // $n contient un rang au hasard
$p = rand(0, sizeof($tabloPrenom) - 1);      // $p contient un rang au hasard
$id = substr($tabloNomFamille[$n], 0, 4);

// Connexion à la base de données (assurez-vous que $cnxBDD est défini avant cette partie du code)

// Parcourt le tableau des villes
foreach ($tabloVille as $ligne) {
    // Explode la ligne en utilisant le point-virgule comme séparateur
    $data = explode(';', $ligne);

    // Vérifie si l'explode a réussi
    if (count($data) >= 4) {
        // Récupère les données nécessaires
        $codeCommune = $data[0];
        $nomCommune = $data[1];
        $codePostal = $data[2];

        // Insertion dans la table ETUDIANT du nième nom de famille et du pième prénom 
        $sql = "INSERT INTO visiteur(VIS_ID, VIS_NOM, VIS_PRENOM, VIS_ADRESSE, VIS_CP, VIS_VILLE, VIS_DATE_EMBAUCHE) VALUES ('$id', '$tabloNomFamille[$n]', '$tabloPrenom[$p]', NULL, '$codePostal', '$nomCommune', NULL)";

        echo "sql : " . $sql . "<br />";
        $result = $cnxBDD->query($sql) or die("Requête invalide : " . $sql);
    } else {
        echo "Erreur lors de la décomposition des données." . PHP_EOL;
    }
}
?>
